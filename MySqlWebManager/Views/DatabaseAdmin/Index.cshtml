@page

@*@model*@
@*@{ ViewData["TitleHeader"] = ViewData["Title"]; }*@

@section Scripts{

}

<!DOCTYPE html>
<html>
<head>
    <title>代码生成器-Mysql版</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            font-size: 12px;
        }
    </style>
    <link href="@Url.Content("~/lib/layui/dist/css/layui.css")" rel="stylesheet">
    <script src="@Url.Content("~/lib/jquery/dist/jquery.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/lib/axios/dist/axios.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/lib/layui/dist/layui.js")"></script>
    <script>
        var connUrl = "/DatabaseAdmin/GetTablesList";
        var tablefieldUrl="/DatabaseAdmin/GetTableFieldsList";
        function check(checked) {
            $("input[name=cb3]").attr("checked", checked);
        }

        function copytext() {
            window.clipboardData.setData("Text", $("#txt_content").val());
            alert("复制成功！");
        }

        function connection() {
            var serverVal = $("#txt_server").val().trim();
            var dbVal = $("#txt_db").val().trim();
            var uidVal = $("#txt_uid").val().trim();
            var pwdVal = $("#txt_pwd").val().trim();

            var paramsdata = { txt_server: serverVal, txt_db: dbVal, txt_uid: uidVal, txt_pwd: pwdVal };

            axios({
                url: connUrl,
                method: 'POST',
                data: paramsdata
            }).then(function (res) {
                /*  console.log(res.data);*/
                var tableNameList = res.data
                for (i = 0; i < tableNameList.length; i++) {
                    $("#select_tables").append('<option value="' + tableNameList[i] + '">' + tableNameList[i]+ '</option>');
                }
            });
        }

        function loaddatas(obj){
          layui.use(['laydate', 'laypage', 'layer', 'table'],function () {
                var laydate = layui.laydate //日期
                , laypage = layui.laypage //分页
                , layer = layui.layer //弹层
                , table = layui.table //表格


                table.render({
                    elem: '#gv_fileds',
                    url: tablefieldUrl,
                    loading: true
                    , data: obj  //此处是请求的ajax接口数据
                    , title: 'Table单',
                    toolbar: '<span>Table单</span>',
                    page: { //支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
                        layout: ['limit', 'count', 'prev', 'page', 'next', 'skip'] //自定义分页布局
                        //,curr: 5 //设定初始在第 5 页
                        ,
                        groups: 1 //只显示 1 个连续页码
                        ,
                        first: false //不显示首页
                        ,
                        last: false //不显示尾页

                    },
                    cols: [
                        [
                            { field: 'id', width: 80, title: '排序', templet: function (d) {
                                    if(d.vip_type == 1){
                                        res = "钻石会员"
                                    }else{
                                        res = "至尊会员"
                                    }
                                        return res;
                             } },
                            { field: '', width: 100, title: '查询条件',templet: function (d) {
                                    if(d.vip_type == 1){
                                        res = "钻石会员"
                                    }else{
                                        res = "至尊会员"
                                    }
                                        return res;
                             }},
                            { field: '', width: 80, title: '字段勾选',templet: function (d) {
                                    if(d.vip_type == 1){
                                        res = "钻石会员"
                                    }else{
                                        res = "至尊会员"
                                    }
                                        return res;
                             }},
                            { field: 'Name', width: 80, title: '字段名称' },
                            { field: 'Type', title: '字段类型', minWidth: 150 },
                            { field: 'Len', width: 80, title: '字段长度', sort: true },
                            { field: 'Info', width: 80, title: '字段备注', sort: true },
                            { field: '', width: 80, title: '' },
                            { field: '', width: 135, title: '', sort: true }
                        ]
                    ]

                });
            });
        }

        $(function(){

        $("#btnConnection").click(function(){
          connection();
        });

        $("#select_tables").change(function(){  //获取select标签，并注册change事件

          var ov=$(this).find('option:selected').val();//获取选中的option的value值
          if(ov!=null && ov!="")
          { 
                var paramsdata = { tablename: ov};
                loaddatas(paramsdata);

                //axios({
                //url: tablefieldUrl,
                //method: 'POST',
                //data: paramsdata
                //}).then(function (res) {
                //    var tableFieldList = res.data
                //    for (i = 0; i < tableFieldList.length; i++) {
                       
                //    }
                //});
          }
          else
          {
              alert("请选中一张表")
          }
        })

        });
    </script>
</head>
<body>
    @*<table border="1" cellspacing="0" cellpadding="0" width="1000px">
        <tr width="200">
        <th colspan="4" scope="col" align="left">
        server:<input type="text" ID="txt_server" />192.168.1.64
        &nbsp;database:
        <input type="text" ID="txt_db" />cw_workcategory_listenning_ch
        &nbsp;uid:<input type="text" ID="txt_uid" />
        root
        pwd:<input type="text" ID="txt_pwd" />
        root
        &nbsp;<button ID="Button1" Text="Connection" OnClick="Button1_Click"></button>
        </th>
        </tr>
        <tr>
        <td valign="top" width="200px">
        Tables:<br />
        <asp:ListBox ID="lb_tables" Height="321px" Width="200px" AutoPostBack="True"
        OnSelectedIndexChanged="lb_tables_SelectedIndexChanged">
        </asp:ListBox>
        </td>
        <td valign="top" width="200px">
        <br />
        <br />
        <br />
        <input type="checkbox" ID="cb_add" Text="增加" checked="true" />
        <br />
        <input type="checkbox" ID="cb_delete" Text="删除" checked="true" />
        <br />
        <input type="checkbox" ID="cb_update" Text="修改" checked="true" />
        <br />
        <input type="checkbox" ID="cb_getmodel" Text="单条" checked="true" />
        <br />
        <input type="checkbox" ID="cb_list" Text="列表" checked="true" />
        <br />
        <input type="checkbox" ID="cb_pagelist" Text="分页" checked="true" />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <button ID="Button3" Text="生成语句" Width="104px" OnClick="Button3_Click"></button>
        <button ID="Button4" Text="生成实体" OnClick="Button4_Click"></button>
        <br />
        <br />
        <a href="javascript:;" onclick="$('#div_pl').slideDown()">批量生成实体</a>
        <div style="display: none" id="div_pl">
        命名空间:<input type="text" ID="txt_namespace" Width="250px" />CiWong.ClassZone.Entities<br />
        存放路径:<input type="text" ID="txt_file" Width="250px" />d:\modelcode\<br />
        <button ID="Button2" Text="批量生成" onclick="Button2_Click"></button>
        </div>
        <br />
        </td>
        <td valign="top">
        Fileds:
        <asp:GridView ID="gv_fileds" AutoGenerateColumns="False">
        <Columns>
        <asp:TemplateField HeaderText="排序">
        <ItemTemplate>
        <input type="checkbox" name="cb_order" value="@# Eval(" name")"=name")" @=0)?"checked":"" />
        <select name="ddl_@# Eval(" name")"=name")">
        <option value="desc">降序</option>
        <option value="asc">升序</option>
        </select>
        </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="查询条件">
        <ItemTemplate>
        <input type="checkbox" name="cb2" value="@# Eval(" name")"=name")" />
        </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="字段<input type='checkbox' onclick='check(this.checked)' checked />">
        <ItemTemplate>
        <input type="checkbox" name="cb3" value="@# Eval(" name")"=name")" checked="checked" style="float: right" />
        </ItemTemplate>
        </asp:TemplateField>
        <asp:BoundField DataField="name" HeaderText="字段" />
        <asp:BoundField DataField="type" HeaderText="类型" />
        <asp:BoundField DataField="len" HeaderText="长度" />
        <asp:BoundField DataField="info" HeaderText="备注" />
        </Columns>
        </asp:GridView>
        </td>
        </tr>
        </table>*@

    <table border="1" cellspacing="0" cellpadding="0" width="1000px" id="test">
      @*  <tr width="200">
            <th colspan="4" scope="col" align="left">
                <label class="layui-form-label">server:</label>
                <input name="txt_server" type="text" class="layui-input" value="127.0.0.1" id="txt_server">
                &nbsp;database:<input name="txt_db" type="text" class="layui-input" value="blog" id="txt_db">
                &nbsp;uid:<input name="txt_uid" type="text" class="layui-input" value="root" id="txt_uid">
                pwd:<input name="txt_pwd" type="text" class="layui-input" value="root" id="txt_pwd">
                &nbsp;<button name="btnConnection" id="btnConnection">Connection 加载表</button>
            </th>
        </tr>*@
        <tr>
            <td valign="top" width="200px">
                Tables:<br />
                <select size="20" name="select_tables" onchange="" id="select_tables" style="height:321px;width:200px;">
                    @* <option selected="selected" value="m_blog_article">m_blog_article</option>
                        <option value="m_user">m_user</option>*@
                </select>
            </td>
            <td valign="top" width="200px">
                <br />
                <br />
                <br />
                <input id="cb_add" type="checkbox" name="cb_add" checked="checked"><label for="cb_add">增加</label>
                <br>
                <input id="cb_delete" type="checkbox" name="cb_delete" checked="checked"><label for="cb_delete">删除</label>
                <br>
                <input id="cb_update" type="checkbox" name="cb_update" checked="checked"><label for="cb_update">修改</label>
                <br>
                <input id="cb_getmodel" type="checkbox" name="cb_getmodel" checked="checked"><label for="cb_getmodel">单条</label>
                <br>
                <input id="cb_list" type="checkbox" name="cb_list" checked="checked"><label for="cb_list">列表</label>
                <br>
                <input id="cb_pagelist" type="checkbox" name="cb_pagelist" checked="checked"><label for="cb_pagelist">分页</label>
                <br />
                <br />
                <br />
                <br />
                <br />
                <br />
                <button name="Button3" value="生成语句" id="Button3" style="width:104px;"></button>
                <button name="Button4" value="生成实体" id="Button4"></button>
                <br />
                <br />
                <a href="javascript:;" onclick="$('#div_pl').slideDown()">批量生成实体</a>
                <div style="display: none" id="div_pl">
                    命名空间:<input name="txt_namespace" type="text" value="CiWong.cw_workcategory_listenning_ch.Entities" id="txt_namespace" style="width:250px;">
                    <br />
                    存放路径:<input name="txt_file" type="text" value="d:\modelcode\" id="txt_file" style="width:250px;">
                    <br />
                    <button name="Button2" id="Button2">批量生成</button>
                </div>
                <br />
            </td>
            <td valign="top">
                Fileds:
                <table cellspacing="0" rules="all" border="1" id="gv_fileds" style="border-collapse:collapse;">
                    <tbody>
                        <tr>
                            <th scope="col">排序</th>
                            <th scope="col">查询条件</th>
                            <th scope="col">字段<input type="checkbox" onclick="check(this.checked)" checked=""></th>
                            <th scope="col">字段</th>
                            <th scope="col">类型</th>
                            <th scope="col">长度</th>
                            <th scope="col">备注</th>
                        </tr>
                        <tr>
                            <td>
                                <input type="checkbox" name="cb_order" value="id" checked="">
                                <select name="ddl_id">
                                    <option value="desc">降序</option>
                                    <option value="asc">升序</option>
                                </select>
                            </td>
                            <td>
                                <input type="checkbox" name="cb2" value="id">
                            </td>
                            <td>
                                <input type="checkbox" name="cb3" value="id" checked="checked" style="float: right">
                            </td>
                            <td>id</td>
                            <td>int</td>
                            <td>&nbsp;</td>
                            <td>文章ID</td>
                        </tr>
                        <tr>
                            <td>
                                <input type="checkbox" name="cb_order" value="type_id">
                                <select name="ddl_type_id">
                                    <option value="desc">降序</option>
                                    <option value="asc">升序</option>
                                </select>
                            </td>
                            <td>
                                <input type="checkbox" name="cb2" value="type_id">
                            </td>
                            <td>
                                <input type="checkbox" name="cb3" value="type_id" checked="checked" style="float: right">
                            </td>
                            <td>type_id</td>
                            <td>int</td>
                            <td>&nbsp;</td>
                            <td>文章分类ID</td>
                        </tr>
                        <tr>
                            <td>
                                <input type="checkbox" name="cb_order" value="article_name">
                                <select name="ddl_article_name">
                                    <option value="desc">降序</option>
                                    <option value="asc">升序</option>
                                </select>
                            </td>
                            <td>
                                <input type="checkbox" name="cb2" value="article_name">
                            </td>
                            <td>
                                <input type="checkbox" name="cb3" value="article_name" checked="checked" style="float: right">
                            </td>
                            <td>article_name</td>
                            <td>varchar</td>
                            <td>50</td>
                            <td>文章名称</td>
                        </tr>
                        <tr>
                            <td>
                                <input type="checkbox" name="cb_order" value="article_desc">
                                <select name="ddl_article_desc">
                                    <option value="desc">降序</option>
                                    <option value="asc">升序</option>
                                </select>
                            </td>
                            <td>
                                <input type="checkbox" name="cb2" value="article_desc">
                            </td>
                            <td>
                                <input type="checkbox" name="cb3" value="article_desc" checked="checked" style="float: right">
                            </td>
                            <td>article_desc</td>
                            <td>varchar</td>
                            <td>100</td>
                            <td>文章内容</td>
                        </tr>
                        <tr>
                            <td>
                                <input type="checkbox" name="cb_order" value="create_by">
                                <select name="ddl_create_by">
                                    <option value="desc">降序</option>
                                    <option value="asc">升序</option>
                                </select>
                            </td>
                            <td>
                                <input type="checkbox" name="cb2" value="create_by">
                            </td>
                            <td>
                                <input type="checkbox" name="cb3" value="create_by" checked="checked" style="float: right">
                            </td>
                            <td>create_by</td>
                            <td>varchar</td>
                            <td>20</td>
                            <td>创建人</td>
                        </tr>
                        <tr>
                            <td>
                                <input type="checkbox" name="cb_order" value="create_time">
                                <select name="ddl_create_time">
                                    <option value="desc">降序</option>
                                    <option value="asc">升序</option>
                                </select>
                            </td>
                            <td>
                                <input type="checkbox" name="cb2" value="create_time">
                            </td>
                            <td>
                                <input type="checkbox" name="cb3" value="create_time" checked="checked" style="float: right">
                            </td>
                            <td>create_time</td>
                            <td>timestamp</td>
                            <td>&nbsp;</td>
                            <td>创建时间</td>
                        </tr>
                        <tr>
                            <td>
                                <input type="checkbox" name="cb_order" value="update_by">
                                <select name="ddl_update_by">
                                    <option value="desc">降序</option>
                                    <option value="asc">升序</option>
                                </select>
                            </td>
                            <td>
                                <input type="checkbox" name="cb2" value="update_by">
                            </td>
                            <td>
                                <input type="checkbox" name="cb3" value="update_by" checked="checked" style="float: right">
                            </td>
                            <td>update_by</td>
                            <td>varchar</td>
                            <td>20</td>
                            <td>修改人</td>
                        </tr>
                        <tr>
                            <td>
                                <input type="checkbox" name="cb_order" value="update_time">
                                <select name="ddl_update_time">
                                    <option value="desc">降序</option>
                                    <option value="asc">升序</option>
                                </select>
                            </td>
                            <td>
                                <input type="checkbox" name="cb2" value="update_time">
                            </td>
                            <td>
                                <input type="checkbox" name="cb3" value="update_time" checked="checked" style="float: right">
                            </td>
                            <td>update_time</td>
                            <td>timestamp</td>
                            <td>&nbsp;</td>
                            <td>修改时间</td>
                        </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    </table>

    <table>
        <tr>
            <td colspan="4" align="right">
                <input type="text" ID="txt_content" Height="610px" TextMode="MultiLine" Width="1000px" Style="margin-top: 0px; font-family: inherit; font-size: 12px; color: blue" />
                <br />
                <label style="cursor: pointer; border: 1px solid red" onclick="copytext();">
                    复制
                </label>
                <label onclick="$('#txt_content').height($('#txt_content').height() + 600)" style="cursor: pointer; border: 1px solid red">
                    扩大↓
                </label>
                <label style="cursor: pointer; border: 1px solid red" onclick="$('#txt_content').height($('#txt_content').height() - 300)">
                    缩小↑
                </label>
                <label style="cursor: pointer; border: 1px solid red" onclick="$('#txt_content').height(600)">
                    原始
                </label>
            </td>
        </tr>
    </table>

    <div class="layui-row">
        <div class="layui-inline ">
            <label class="layui-form-label ">server:</label>
            <div class="layui-input-inline">
                <input type="text" name="txt_server" id="txt_server" value="127.0.0.1" lay-verify="required" class="layui-input">
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">database:</label>
            <div class="layui-input-inline">
                <input type="text" name="txt_db" id="txt_db" value="blog" lay-verify="required" class="layui-input">
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">uid:</label>
            <div class="layui-input-inline">
                <input type="text" name="txt_uid" id="txt_uid" value="root" lay-verify="required" class="layui-input" style="">
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">pwd:</label>
            <div class="layui-input-inline">
                <input type="text" name="txt_pwd" id="txt_pwd" value="root" lay-verify="required" class="layui-input" style="">
            </div>
        </div>
        <div class="layui-inline">
            <div class="layui-input-inline">
                <button name="btnConnection" id="btnConnection" class="layui-btn">Connection 加载表</button>
            </div>
        </div>

        @*  <input name="txt_server" type="text" class="layui-input" value="127.0.0.1" id="txt_server">
            <input name="txt_db" type="text" class="layui-input" value="blog" id="txt_db">
            <input name="txt_uid" type="text" class="layui-input" value="root" id="txt_uid">
            pwd:<input name="txt_pwd" type="text" class="layui-input" value="root" id="txt_pwd">
        *@
    </div>
    <div class="layui-fluid" style=" background-color: #63BA79; height: 100px;">
        <div class="layui-row">
            <div class="layui-col-xs12 layui-col-md8">
                <div class="grid-demo grid-demo-bg1">
                    移动：12/12、桌面：8/12

                </div>
            </div>
            <div class="layui-col-xs6 layui-col-md4">
                <div class="grid-demo">
                    移动：6/12、桌面：4/12
                </div>
            </div>
            <div class="layui-col-xs6 layui-col-md12">
                <div class="grid-demo grid-demo-bg2">
                    移动：6/12、桌面：12/12
                </div>
            </div>
        </div>
    </div>
    <script>
        layui.use('table',function () {
                var table = layui.table;
                table.render({
                    elem: '#test',
                    url: '/static/json/table/user.json',
                    page: { //支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
                        layout: ['limit', 'count', 'prev', 'page', 'next', 'skip'] //自定义分页布局
                        //,curr: 5 //设定初始在第 5 页
                        ,
                        groups: 1 //只显示 1 个连续页码
                        ,
                        first: false //不显示首页
                        ,
                        last: false //不显示尾页

                    },
                    cols: [
                        [
                            { field: 'id', width: 80, title: '排序', templet: function (d) {
                                    if(d.vip_type == 1){
                                        res = "钻石会员"
                                    }else{
                                        res = "至尊会员"
                                    }
                                        return res;
                             } },
                            { field: '', width: 100, title: '查询条件',templet: function (d) {
                                    if(d.vip_type == 1){
                                        res = "钻石会员"
                                    }else{
                                        res = "至尊会员"
                                    }
                                        return res;
                             }},
                            { field: '', width: 80, title: '字段勾选',templet: function (d) {
                                    if(d.vip_type == 1){
                                        res = "钻石会员"
                                    }else{
                                        res = "至尊会员"
                                    }
                                        return res;
                             }},
                            { field: 'Name', width: 80, title: '字段名称' },
                            { field: 'Type', title: '字段类型', minWidth: 150 },
                            { field: 'Len', width: 80, title: '字段长度', sort: true },
                            { field: 'Info', width: 80, title: '字段备注', sort: true },
                            { field: '', width: 80, title: '' },
                            { field: '', width: 135, title: '', sort: true }
                        ]
                    ]

                });
            });
    </script>
</body>
</html>