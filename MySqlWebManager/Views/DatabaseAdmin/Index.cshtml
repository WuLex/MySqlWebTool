@{







    Layout = null;
}

@*@model*@
@*@{ ViewData["TitleHeader"] = ViewData["Title"]; }*@

@section Scripts{

}

<!DOCTYPE html>
<html>

<head>
    <title>代码生成器-Mysql版</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            font-size: 12px;
        }
    </style>
    <link href="@Url.Content("~/lib/layui/dist/css/layui.css")" rel="stylesheet">
    <script src="@Url.Content("~/lib/jquery/dist/jquery.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/lib/axios/dist/axios.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/lib/layui/dist/layui.js")"></script>

</head>

<body>
    <form class="layui-form layui-form-pane" action="">
        <input id="connectionId" name="ConnectionId" type="hidden" value="" />
        <div class="layui-row">
            <div class="layui-inline ">
                <label class="layui-form-label ">server:</label>
                <div class="layui-input-inline">
                    <input type="text" name="txt_server" id="txt_server" value="127.0.0.1" lay-verify="required"
                        class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">database:</label>
                <div class="layui-input-inline">
                    <input type="text" name="txt_db" id="txt_db" value="blog" lay-verify="required" class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">uid:</label>
                <div class="layui-input-inline">
                    <input type="text" name="txt_uid" id="txt_uid" value="root" lay-verify="required"
                        class="layui-input" style="">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">pwd:</label>
                <div class="layui-input-inline">
                    <input type="text" name="txt_pwd" id="txt_pwd" value="" lay-verify="required" class="layui-input"
                        style="">
                </div>
            </div>
            <div class="layui-inline">
                <div class="layui-input-inline">
                    <button name="btnConnection" id="btnConnection" class="layui-btn">Connection 加载表</button>
                </div>
            </div>
        </div>
        <hr class="layui-border-green">
        <table border="1" cellspacing="0" cellpadding="0" width="1500px" id="test">
            <tr>
                <td valign="top" width="200px">
                    Tables:<br />
                    <select size="20" name="select_tables" id="select_tables" style="height:321px;width:200px;">
                    </select>
                </td>
                <td valign="top" width="30%">
                    <br />
                    <br />
                    <br />
                    @*<div class="layui-form-item">
                        <label class="layui-form-label">复选框</label>
                        <div class="layui-input-block">
                        <input type="checkbox" name="like[write]" title="写作">
                        <input type="checkbox" name="like[read]" title="阅读" checked="">
                        <input type="checkbox" name="like[game]" title="游戏">
                        </div>
                        </div>*@

                    <div class="layui-form-item" pane="">
                        <label class="layui-form-label" style="width:auto">生成代码包含</label>
                        <div class="layui-input-block">
                            <input type="checkbox" name="cb_add" lay-skin="primary" title="增加" id="cb_add"
                                checked="checked">
                            <br>
                            <input type="checkbox" name="cb_delete" lay-skin="primary" title="删除" id="cb_delete"
                                checked="checked">
                            <br>
                            <input type="checkbox" name="cb_update" lay-skin="primary" title="修改" id="cb_update"
                                checked="checked">
                            <br>
                            <input type="checkbox" name="cb_getmodel" lay-skin="primary" title="单条" id="cb_getmodel"
                                checked="checked">
                            <br>
                            <input type="checkbox" name="cb_list" lay-skin="primary" title="列表" id="cb_list"
                                checked="checked">
                            <br>
                            <input type="checkbox" name="cb_pagelist" lay-skin="primary" title="分页" id="cb_pagelist"
                                checked="checked">
                        </div>
                    </div>

                    @* <input id="cb_add" type="checkbox" name="cb_add" checked="checked">
                        <label for="cb_add">增加</label>
                        <br>
                        <input id="cb_delete" type="checkbox" name="cb_delete" checked="checked">
                        <label for="cb_delete">删除</label>
                        <br>
                        <input id="cb_update" type="checkbox" name="cb_update" checked="checked">
                        <label for="cb_update">修改</label>
                        <br>
                        <input id="cb_getmodel" type="checkbox" name="cb_getmodel" checked="checked">
                        <label for="cb_getmodel">单条</label>
                        <br>
                        <input id="cb_list" type="checkbox" name="cb_list" checked="checked">
                        <label for="cb_list">列表</label>
                        <br>
                        <input id="cb_pagelist" type="checkbox" name="cb_pagelist" checked="checked">
                        <label for="cb_pagelist">分页</label>*@
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <button name="Button3" value="生成语句" class="layui-btn" id="btnGenerateSql"
                        style="">生成语句Button3</button>

                    <button name="Button4" value="生成实体" class="layui-btn" id="btnGenerateEntity">生成实体Button4</button>
                    <br />
                    <br />

                    <span class="layui-breadcrumb" lay-separator="|">
                        <a href="javascript:;" onclick="$('#div_pl').slideDown()">批量生成实体</a>
                    </span>

                    <div class="layui-card" id="div_pl" style="display:none;">
                        @*<div class="layui-card-header">卡片面板</div>*@
                        <div class="layui-card-body">
                            命名空间:<input name="txt_namespace" type="text" class="layui-input"
                                value="CiWong.cw_workcategory_listenning_ch.Entities" id="txt_namespace"
                                style="width:250px;">
                            <br />
                            存放路径:<input name="txt_file" type="text" class="layui-input" value="d:\modelcode\"
                                id="txt_file" style="width:250px;">
                            <br />
                            <button name="Button2" value="批量生成" class="layui-btn layui-btn-normal" id="btnBatchGeneration">批量生成Button2</button>
                        </div>
                    </div>

                    @* <div style="display:none;" id="div_pl">
                        命名空间:<input name="txt_namespace" type="text" value="CiWong.cw_workcategory_listenning_ch.Entities"
                        id="txt_namespace" style="width:250px;">
                        <br />
                        存放路径:<input name="txt_file" type="text" value="d:\modelcode\" id="txt_file" style="width:250px;">
                        <br />
                        <button name="Button2" value="批量生成" class="layui-btn layui-btn-normal"
                        id="btnBatchGenerate">批量生成Button2</button>
                        </div>*@
                    <br />
                </td>
                <td valign="top">
                    Fileds:
                    @* <table cellspacing="0" rules="all" border="1" id="gv_fileds" style="border-collapse:collapse;">
                        <tbody>
                        <tr>
                        <th scope="col">排序</th>
                        <th scope="col">查询条件</th>
                        <th scope="col">字段<input type="checkbox" onclick="check(this.checked)" checked=""></th>
                        <th scope="col">字段</th>
                        <th scope="col">类型</th>
                        <th scope="col">长度</th>
                        <th scope="col">备注</th>
                        </tr>
                        <tr>
                        <td>
                        <input type="checkbox" name="cb_order" value="id" checked="">
                        <select name="ddl_id">
                        <option value="desc">降序</option>
                        <option value="asc">升序</option>
                        </select>
                        </td>
                        <td>
                        <input type="checkbox" name="cb2" value="id">
                        </td>
                        <td>
                        <input type="checkbox" name="cb3" value="id" checked="checked" style="float: right">
                        </td>
                        <td>id</td>
                        <td>int</td>
                        <td>&nbsp;</td>
                        <td>文章ID</td>
                        </tr>
                        <tr>
                        <td>
                        <input type="checkbox" name="cb_order" value="type_id">
                        <select name="ddl_type_id">
                        <option value="desc">降序</option>
                        <option value="asc">升序</option>
                        </select>
                        </td>
                        <td>
                        <input type="checkbox" name="cb2" value="type_id">
                        </td>
                        <td>
                        <input type="checkbox" name="cb3" value="type_id" checked="checked"
                        style="float: right">
                        </td>
                        <td>type_id</td>
                        <td>int</td>
                        <td>&nbsp;</td>
                        <td>文章分类ID</td>
                        </tr>
                        <tr>
                        <td>
                        <input type="checkbox" name="cb_order" value="article_name">
                        <select name="ddl_article_name">
                        <option value="desc">降序</option>
                        <option value="asc">升序</option>
                        </select>
                        </td>
                        <td>
                        <input type="checkbox" name="cb2" value="article_name">
                        </td>
                        <td>
                        <input type="checkbox" name="cb3" value="article_name" checked="checked"
                        style="float: right">
                        </td>
                        <td>article_name</td>
                        <td>varchar</td>
                        <td>50</td>
                        <td>文章名称</td>
                        </tr>
                        <tr>
                        <td>
                        <input type="checkbox" name="cb_order" value="article_desc">
                        <select name="ddl_article_desc">
                        <option value="desc">降序</option>
                        <option value="asc">升序</option>
                        </select>
                        </td>
                        <td>
                        <input type="checkbox" name="cb2" value="article_desc">
                        </td>
                        <td>
                        <input type="checkbox" name="cb3" value="article_desc" checked="checked"
                        style="float: right">
                        </td>
                        <td>article_desc</td>
                        <td>varchar</td>
                        <td>100</td>
                        <td>文章内容</td>
                        </tr>
                        <tr>
                        <td>
                        <input type="checkbox" name="cb_order" value="create_by">
                        <select name="ddl_create_by">
                        <option value="desc">降序</option>
                        <option value="asc">升序</option>
                        </select>
                        </td>
                        <td>
                        <input type="checkbox" name="cb2" value="create_by">
                        </td>
                        <td>
                        <input type="checkbox" name="cb3" value="create_by" checked="checked"
                        style="float: right">
                        </td>
                        <td>create_by</td>
                        <td>varchar</td>
                        <td>20</td>
                        <td>创建人</td>
                        </tr>
                        <tr>
                        <td>
                        <input type="checkbox" name="cb_order" value="create_time">
                        <select name="ddl_create_time">
                        <option value="desc">降序</option>
                        <option value="asc">升序</option>
                        </select>
                        </td>
                        <td>
                        <input type="checkbox" name="cb2" value="create_time">
                        </td>
                        <td>
                        <input type="checkbox" name="cb3" value="create_time" checked="checked"
                        style="float: right">
                        </td>
                        <td>create_time</td>
                        <td>timestamp</td>
                        <td>&nbsp;</td>
                        <td>创建时间</td>
                        </tr>
                        <tr>
                        <td>
                        <input type="checkbox" name="cb_order" value="update_by">
                        <select name="ddl_update_by">
                        <option value="desc">降序</option>
                        <option value="asc">升序</option>
                        </select>
                        </td>
                        <td>
                        <input type="checkbox" name="cb2" value="update_by">
                        </td>
                        <td>
                        <input type="checkbox" name="cb3" value="update_by" checked="checked"
                        style="float: right">
                        </td>
                        <td>update_by</td>
                        <td>varchar</td>
                        <td>20</td>
                        <td>修改人</td>
                        </tr>
                        <tr>
                        <td>
                        <input type="checkbox" name="cb_order" value="update_time">
                        <select name="ddl_update_time">
                        <option value="desc">降序</option>
                        <option value="asc">升序</option>
                        </select>
                        </td>
                        <td>
                        <input type="checkbox" name="cb2" value="update_time">
                        </td>
                        <td>
                        <input type="checkbox" name="cb3" value="update_time" checked="checked"
                        style="float: right">
                        </td>
                        <td>update_time</td>
                        <td>timestamp</td>
                        <td>&nbsp;</td>
                        <td>修改时间</td>
                        </tr>
                        </tbody>
                        </table>*@
                    <table cellspacing="0" rules="all" border="1" id="tablefields" style="border-collapse:collapse;">
                    </table>
                </td>
            </tr>
        </table>

        <table>
            <tr>
                <td colspan="4" align="right">
                    <div class="layui-form-item layui-form-text">
                        <label class="layui-form-label">生成的内容</label>
                        <div class="layui-input-block">
                            @*<textarea placeholder="请输入内容" class="layui-textarea"></textarea>*@
                            <textarea placeholder="生成的结果内容" class="layui-textarea" name="txt_content" rows="2" cols="20"
                                id="txt_content"
                                style="height:610px;width:1000px;margin-top: 0px; font-family: inherit; font-size: 12px; color: blue"></textarea>
                        </div>
                    </div>
                    <br />

                    <div class="layui-btn-container">
                        <button type="button" class="layui-btn layui-btn-primary" id="demo4">
                            内容框大小调整
                            <i class="layui-icon layui-icon-more-vertical layui-font-12"></i>
                        </button>
                    </div>

                    <label class="layui-form-label" style="cursor: pointer; border: 1px solid red"
                        onclick="copytext();">
                        复制
                    </label>
                    <label class="layui-form-label" onclick="$('#txt_content').height($('#txt_content').height() + 600)"
                        style="cursor: pointer; border: 1px solid red">
                        扩大↓
                    </label>
                    <label class="layui-form-label" style="cursor: pointer; border: 1px solid red"
                        onclick="$('#txt_content').height($('#txt_content').height() - 300)">
                        缩小↑
                    </label>
                    <label class="layui-form-label" style="cursor: pointer; border: 1px solid red"
                        onclick="$('#txt_content').height(600)">
                        原始
                    </label>
                </td>
            </tr>
        </table>

    </form>


    <div class="layui-inline" style="width: 235px;">
        <input name="" placeholder="在输入框提供一些常用的选项" class="layui-input" id="demo2">
    </div>
    <div class="layui-fluid" style=" background-color: #63BA79; height: 100px;">
        <div class="layui-row">
            <div class="layui-col-xs12 layui-col-md8">
                <div class="grid-demo grid-demo-bg1">
                    移动：12/12、桌面：8/12

                </div>
            </div>
            <div class="layui-col-xs6 layui-col-md4">
                <div class="grid-demo">
                    移动：6/12、桌面：4/12
                </div>
            </div>
            <div class="layui-col-xs6 layui-col-md12">
                <div class="grid-demo grid-demo-bg2">
                    移动：6/12、桌面：12/12
                </div>
            </div>
        </div>
    </div>
    <script>
        var connUrl = "/DatabaseAdmin/GetTablesList";
        var tablefieldUrl = "/DatabaseAdmin/GetTableFieldsList";
        function check(checked) {
            $("input[name=cb3]").attr("checked", checked);
        }

        function copytext() {
            window.clipboardData.setData("Text", $("#txt_content").val());
            alert("复制成功！");
        }

        function connection() {
            var serverVal = $("#txt_server").val().trim();
            var dbVal = $("#txt_db").val().trim();
            var uidVal = $("#txt_uid").val().trim();
            var pwdVal = $("#txt_pwd").val().trim();

            var paramsdata = { Server: serverVal, Db: dbVal, Uid: uidVal, Pwd: pwdVal };

            axios({
                url: connUrl,
                method: 'POST',
                data: paramsdata
            }).then(function (res) {
                /*  console.log(res.data);*/
                var list = res.data
                $("#select_tables").empty();
                for (i = 0; i < list.tableNameList.length; i++) {
                    $("#select_tables").append('<option value="' + list.tableNameList[i] + '">' + list.tableNameList[i] + '</option>');
                }
                //存储连接字符串ID
                $("#connectionId").val(list.connectionId);
            });
        }

        function loaddatas(obj) {

            //var mycars = new Array();
            //var result;
            //obj.page=1;
            //obj.limit=10;

            ////动态列和数据
            //axios({
            //    url: tablefieldUrl,
            //    method: 'POST',
            //    data: obj
            //    }).then(function (res) {
            //        var tableFieldList = res.data
            //        for (i = 0; i < tableFieldList.length; i++) {

            //        }
            //        result = data.Data;
            //        var strs = new Array();
            //                 strs = result[0];
            //                 for (var k in strs) {
            //                     mycars.push({
            //                         field: k, title: k, align: 'center', width: 120, sort: false
            //                     });
            //                 }
            //    });

            layui.use(['laydate', 'laypage', 'layer', 'table'], function () {

                var trIndex = 0;
                var laydate = layui.laydate //日期
                    , laypage = layui.laypage //分页
                    , layer = layui.layer //弹层
                    , table = layui.table //表格



                table.render({
                    elem: '#tablefields',
                    url: tablefieldUrl,
                    method: "post", //这里可以写post请求,默认get
                    loading: true,
                    contentType: 'application/json',
                    where: obj,
                    parseData: function (res) { //res 即为原始返回的数据
                        console.log(res);
                        return {
                            "code": res.code, //解析接口状态
                            "msg": res.msg, //解析提示文本
                            "count": res.count, //解析数据长度
                            "data": res.data //解析数据列表
                        };
                    },
                    //data: obj,   //此处是请求的ajax接口数据
                    title: 'Table单',
                    //toolbar: '<span>Table单</span>',
                    page: { //支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
                        layout: ['limit', 'count', 'prev', 'page', 'next', 'skip'] //自定义分页布局
                        //,curr: 5 //设定初始在第 5 页
                        ,
                        groups: 1 //只显示 1 个连续页码
                        ,
                        first: false //不显示首页
                        ,
                        last: false //不显示尾页
                    },
                    cols: [
                        [
                            {
                                width: 200, title: '排序', fixed: "left", templet: function (d) {
                                    res = '<input type="checkbox" name="cb_order" value="' + d.columnName + '" ' + ((trIndex++ == 0) ? "checked" : "") + '/>' +
                                        '<select name="ddl_' + d.columnName + '">' +
                                        '<option value="desc">降序</option>' +
                                        '<option value="asc">升序</option>' +
                                        '</select>';
                                    return res;
                                }
                            },
                            {
                                width: 100, title: '查询条件', templet: function (d) {
                                    res = '<input type="checkbox" name="cb2" value="' + d.columnName + '" />';
                                    return res;
                                }
                            },
                            {
                                width: 100, title: '字段勾选<input type="checkbox" onclick="check(this.checked)" checked/>', templet: function (d) {
                                    res = '<input type="checkbox" name="cb3" value="' + d.columnName + '" checked="checked" style="float: right" />';
                                    return res;
                                }
                            },
                            { field: 'columnName', width: 150, title: '字段名称' },
                            { field: 'datA_TYPE', title: '字段类型', minWidth: 150 },
                            { field: 'maxLen', width: 80, title: '字段长度', sort: true },
                            { field: 'comment', width: 200, title: '字段说明', sort: true },
                            { field: 'iS_NULL', width: 80, title: '是否能为NULL' },
                            { field: 'auto', width: 135, title: '其他信息', sort: true }
                        ]
                    ]

                });
            });
        }

        $(function () {

            $("#btnConnection").click(function () {
                connection();
            });

            $("#select_tables").change(function () {  //获取select标签，并注册change事件

                var ov = $(this).find('option:selected').val();//获取选中的option的value值
                var connid = $("#connectionId").val(); //获取连接字符串ID

                if (ov != null && ov != "") {
                    var paramsdata = { tablename: ov, connectionid: connid };
                    loaddatas(paramsdata);
                }
                else {
                    alert("请选中一张表")
                }
            })

        });
    </script>
    <script>

        //layui.use('dropdown', function(){
        var dropdown = layui.dropdown

        //初演示 - 绑定输入框
        dropdown.render({
            elem: '#demo2'
            , data: [{
                title: 'menu item 1'
                , id: 101
            }, {
                title: 'menu item 2'
                , id: 102
            }, {
                title: 'menu item 3'
                , id: 103
            }, {
                title: 'menu item 4'
                , id: 104
            }, {
                title: 'menu item 5'
                , id: 105
            }, {
                title: 'menu item 6'
                , id: 106
            }]
            , click: function (obj) {
                this.elem.val(obj.title);
            }
            , style: 'width: 235px;'
        });

        //自定义事件 - hover
        dropdown.render({
            elem: '#demo4'
            , trigger: 'hover'
            , data: [{
                title: '复制'
                , id: 100,
                templet: '<label class="" style="" onclick="copytext();"> 复制 </label>'
            }, {
                title: '扩大↓'
                , id: 101,
                templet: ' <label class="" onclick="$(\'#txt_content\').height($(\'#txt_content\').height() + 600)" style="">扩大↓</label>'
            }, {
                title: '缩小↑'
                , id: 102,
                templet: '<label class="" style="" onclick="$(\'#txt_content\').height($(\'#txt_content\').height() - 300)">缩小↑</label>'
            }, {
                title: '原始'
                , id: 103
                , templet: '<label class="" style="" onclick="$(\'#txt_content\').height(600)">原始</label>'
            }, {
                title: 'test'
                //该模板由「图片+标题+徽章」组成
                , templet: '<img src="1.jpg" style="width: 16px;"> <span class="layui-badge-dot"></span>'
                , id: 104
                , href: 'https://www.layui.com/'
                , target: '_blank'
            }]
        });
    </script>
    <script>
        //layui.use('table',function () {
        //        var table = layui.table;
        //        table.render({
        //            elem: '#test',
        //            url: '/static/json/table/user.json',
        //            page: { //支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
        //                layout: ['limit', 'count', 'prev', 'page', 'next', 'skip'] //自定义分页布局
        //                //,curr: 5 //设定初始在第 5 页
        //                ,
        //                groups: 1 //只显示 1 个连续页码
        //                ,
        //                first: false //不显示首页
        //                ,
        //                last: false //不显示尾页

        //            },
        //            cols: [
        //                [
        //                    { field: 'id', width: 80, title: '排序', templet: function (d) {
        //                            if(d.vip_type == 1){
        //                                res = "钻石会员"
        //                            }else{
        //                                res = "至尊会员"
        //                            }
        //                                return res;
        //                     } },
        //                    { field: '', width: 100, title: '查询条件',templet: function (d) {
        //                            if(d.vip_type == 1){
        //                                res = "钻石会员"
        //                            }else{
        //                                res = "至尊会员"
        //                            }
        //                                return res;
        //                     }},
        //                    { field: '', width: 80, title: '字段勾选',templet: function (d) {
        //                            if(d.vip_type == 1){
        //                                res = "钻石会员"
        //                            }else{
        //                                res = "至尊会员"
        //                            }
        //                                return res;
        //                     }},
        //                    { field: 'Name', width: 80, title: '字段名称' },
        //                    { field: 'Type', title: '字段类型', minWidth: 150 },
        //                    { field: 'Len', width: 80, title: '字段长度', sort: true },
        //                    { field: 'Info', width: 80, title: '字段备注', sort: true },
        //                    { field: '', width: 80, title: '' },
        //                    { field: '', width: 135, title: '', sort: true }
        //                ]
        //            ]

        //        });
        //    });
    </script>
</body>

</html>